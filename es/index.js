import t from"axios";import e from"axios-retry";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var n=function(){return n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function r(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(t){i(t)}}function u(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))}function o(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}function i(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}var a,u=t;!function(t){t.GET="GET",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE",t.PATCH="PATCH",t.OPTIONS="OPTIONS"}(a||(a={}));var s=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.typeof=function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},t.empty=function(t){return"boolean"!=typeof t&&("null"===t||("undefined"===t||(!t&&0!==t||(!(!Array.isArray(t)||0!==t.length)||"[object Object]"===Object.prototype.toString.call(t)&&0===Object.keys(t).length))))},t.qsStringify=function(t,e){var n=this;if(!t)return"";var r=new URLSearchParams;return Object.keys(t).forEach((function(o){var i=t[o];switch(n.typeof(i)){case"object":Object.keys(i).forEach((function(t){r.append("".concat(o,"[").concat(t,"]"),"object"==n.typeof(i[t])?JSON.stringify(i[t]):i[t])}));break;case"array":(null==e?void 0:e.arr2str)?r.append(o,i.join(",")):i.filter(Boolean).forEach((function(t,i){var a="object"==n.typeof(t)?JSON.stringify(t):t;(null==e?void 0:e.hasBrackets)?r.append((null==e?void 0:e.hasIndex)?"".concat(o,"[").concat(i,"]"):"".concat(o,"[]"),a):r.append(o,a)}));break;default:r.append(o,i)}})),(null==e?void 0:e.urlEncode)?r.toString():decodeURIComponent(r.toString())},t.qsParse=function(t,e){var n=null!=t?t:window.location.pathname;t=null!=t?t:window.location.search;var r=n.substring(n.lastIndexOf("/")+1),o={"/":null!=r?r:void 0},i=0===t.indexOf("?")?t.substring(1):t;if(0!==i.length)for(var a=i.split("&"),u=0;u<a.length;u++){var s=a[u].split("="),c=decodeURIComponent(s[0]),l=decodeURIComponent(s[1]);o[c]?(!Array.isArray(o[c])&&(o[c]=Array(o[c])),o[c].push(l)):o[c]=l}return e?null==o?void 0:o[e]:o},t.getV=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.length>=2?e.reduce((function(e,n){return e&&e.hasOwnProperty(n)?e[n]:t})):t},t.get1Var=function(t){if("object"!==this.typeof(t)&&!Array.isArray(t))return t;for(var e in t){return t[e]}},t.sleep=function(t){return new Promise((function(e){return setTimeout(e,t)}))},t.arraySet=function(t){return Array.isArray(t)?1==t.length?t:function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],i(new Set(t)),!1):t},t.deepClone=function(t){if("object"!==this.typeof(t)||!Array.isArray(t))return t;var e=Array.isArray(t)?[]:{};for(var n in t)e[n]=this.deepClone(t[n]);return e},t.mergeObj=function(t,e,n,r){for(var o in void 0===r&&(r=!1),e)"object"===this.typeof(e[o])&&this.typeof("object"===t[o])?t[o]=this.mergeObj(t[o],e[o],n):Object.keys(t).includes(o)&&!(null==n?void 0:n.includes(o))||(t[o]=e[o]);if(r)for(var i in t)void 0===e[i]&&delete t[i];return t},t.getRandNum=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=10),Math.floor(t+Math.random()*(e-t+1))},t.getRandColor=function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)},t.getRandStr=function(t){return void 0===t&&(t=1e8),(Math.random()*t).toFixed()},t.getUId=function(t,e){return void 0===t&&(t=1e4),void 0===e&&(e=36),0===t?"".concat(this.formatDate(new Date,"Sssiihhddmmyyyy")):Number("".concat(this.getRandStr(t)).concat(Date.now())).toString(e)},t.str2html=function(t){var e=document.createElement("div");return e.textContent=t,e.innerHTML},t.html2str=function(t){var e=document.createElement("div");return e.innerHTML=t,e.textContent},t.unicode2str=function(t){return escape(t).toLocaleLowerCase().replace(/%u/gi,"\\u")},t.str2unicode=function(t){return unescape(t.replace(/\\u/gi,"%u"))},t.trim=function(t,e){switch(void 0===e&&(e=0),e){case 0:case"ba":return t.trim();case 1:case"b":return t.replace(/^[\s]*/,"");case 2:case"a":return t.replace(/[\s]*$/g,"");case 3:case"all":return t.replace(/\s/g,"");case 4:case"pro":return t.replace(/(^\s*)|(\s*$)|\s(?=\s)/g,"");default:return t}},t.formatFormData=function(t){var e=new FormData;for(var n in t)e.append(n,"object"==this.typeof(t[n])?JSON.stringify(t[n]):t[n]);return e},t.formatBytes=function(t,e){var n;void 0===e&&(e=2);var r=["B","KB","MB","GB","TB"],o=Math.floor((t?Math.log(t):0)/Math.log(1024));o=Math.min(o,r.length-1);var i=null!==(n=null==r?void 0:r[o])&&void 0!==n?n:r[0];return(t/=1<<10*o).toFixed(e)+" "+i},t.formatDate=function(t,e,n){void 0===e&&(e="yyyy-mm-dd hh:ii:ss"),n=null!=n?n:[7,1,2,3,4,5,6];var r={"m+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"i+":t.getMinutes(),"s+":t.getSeconds(),Q:Math.floor((t.getMonth()+3)/3),S:"".concat(t.getMilliseconds()).padStart(3,"0"),W:n[t.getDay()]};for(var o in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,"".concat(t.getFullYear()).substr(4-RegExp.$1.length))),r)new RegExp("("+o+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?r[o]:"00".concat(r[o]).substr("".concat(r[o]).length)));return e},t.base64Encode=function(t){return Buffer.from(t,"utf-8").toString("base64")},t.base64Decode=function(t){return Buffer.from(t,"base64").toString("utf8")},t.data2Obj=function(t,e,n){var r={};return Array.isArray(t)?(t.forEach((function(t){r[t[e]]=n?t[n]:t})),r):r},t.data2Arr=function(t,e){var n,r=[];if(0===t.length)return r;for(var o in t)(null===(n=t[o])||void 0===n?void 0:n[e])&&r.push(t[o][e]);return r},t}(),c=new(function(){function u(e,r){var o,i,a,u,s,c,l,d;return void 0===r&&(r={}),this.timeout=3e4,this._cancelTokens=[],this._whiteListCancelTokens=[],this._cancelDuplicatedRequest=null===(o=null==e?void 0:e.cancelDuplicatedRequest)||void 0===o||o,this._cancelDuplicatedRequest&&(this._pendingRequests=new Map),this._retryConfig=null!==(i=null==e?void 0:e.retryConfig)&&void 0!==i?i:null,this._requestHandler=null!==(a=null==e?void 0:e.requestHandler)&&void 0!==a?a:void 0,this._responseHandler=null!==(u=null==e?void 0:e.responseHandler)&&void 0!==u?u:void 0,this._errorHandler=null!==(s=null==e?void 0:e.errorHandler)&&void 0!==s?s:void 0,this._requestFinally=null!==(c=null==e?void 0:e.requestFinally)&&void 0!==c?c:void 0,this._setRequestHeaders=null!==(l=null==e?void 0:e.setRequestHeaders)&&void 0!==l?l:void 0,this._defaultAxiosConfig=n({timeout:null!==(d=null==e?void 0:e.timeout)&&void 0!==d?d:this.timeout,validateStatus:function(t){return!0}},r),this.instance=t.create(this._defaultAxiosConfig),this._initAxiosRetry(),this._initInterceptors(),this}return u.prototype._initAxiosRetry=function(){var t=this;this._retryConfig&&e(this.instance,{retries:this._retryConfig.retry,retryDelay:function(e){return e*t._retryConfig.delay},shouldResetTimeout:!0,retryCondition:function(t){var n;return!!e.isNetworkOrIdempotentRequestError(t)||(!t.code||(!!["ECONNRESET","ETIMEDOUT"].includes(t.code)||!("ECONNABORTED"!=t.code||!(null===(n=t.message)||void 0===n?void 0:n.includes("timeout")))))}})},u.prototype._initInterceptors=function(){var e=this;this.instance.interceptors.request.use((function(t){var n;if(e._cancelDuplicatedRequest&&!t.cancelToken&&(e._removePendingRequest(t),e._addPendingRequest(t)),"object"===s.typeof(t)&&null!=e._setRequestHeaders&&(t=e._setRequestHeaders.call(e,t),"object"!==s.typeof(t)))throw new Error("XHttp Error: [setRequestHeaders] must be a function, and return a complete object value(RequestConfig) without missing original attributes!");return null===(n=e._requestHandler)||void 0===n||n.call(e,t),t}),(function(n){return t.isCancel(n)||(e._cancelDuplicatedRequest&&e._pendingRequests.clear(),e._whiteListCancelTokens=[],e._cancelTokens=[]),Promise.reject(n)})),this.instance.interceptors.response.use((function(t){var n,r;return e._cancelDuplicatedRequest&&!(null===(n=t.config)||void 0===n?void 0:n.cancelToken)&&e._removePendingRequest(t),null===(r=e._responseHandler)||void 0===r||r.call(e,t),{status:null==t?void 0:t.status,statusText:null==t?void 0:t.statusText,data:null==t?void 0:t.data}}),(function(n){var r;t.isCancel(n)||(e._cancelDuplicatedRequest&&e._pendingRequests.clear(),e._whiteListCancelTokens=[],e._cancelTokens=[]);var o=null!==(r=n.response)&&void 0!==r?r:n;return Promise.reject(o)}))},u.prototype._addPendingRequest=function(e){var n=this,r=[e.method,e.url,JSON.stringify(e.params),JSON.stringify(e.data)].join("&");e.cancelToken=new t.CancelToken((function(t){n._pendingRequests.has(r)||n._pendingRequests.set(r,t)}))},u.prototype._removePendingRequest=function(t){var e=[t.method,t.url,JSON.stringify(t.params),JSON.stringify(t.data)].join("&");this._pendingRequests.has(e)&&(this._pendingRequests.get(e)(e),this._pendingRequests.delete(e))},u.prototype.request=function(e,i,a,u){return void 0===a&&(a={}),void 0===u&&(u=!1),r(this,void 0,void 0,(function(){var r,s,c,l=this;return o(this,(function(o){return r=n(n({},a),{url:i,method:e}),this._cancelDuplicatedRequest&&!u||(s=t.CancelToken.source(),c=s.token,u?this._whiteListCancelTokens.push(s):this._cancelTokens.push(s),r.cancelToken=c),[2,this.instance.request(r).then((function(t){return t})).catch((function(t){var e;return null===(e=l._errorHandler)||void 0===e||e.call(l,t),t})).finally((function(){var t;null===(t=l._requestFinally)||void 0===t||t.call(l)}))]}))}))},u.prototype.get=function(t,e,i,u){return void 0===e&&(e={}),void 0===i&&(i={}),void 0===u&&(u=!1),r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this.request(a.GET,t,n(n({},i),{params:e}),u)]}))}))},u.prototype.post=function(t,e,i,u){return void 0===e&&(e={}),void 0===i&&(i={}),void 0===u&&(u=!1),r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this.request(a.POST,t,n(n({},i),{data:e}),u)]}))}))},u.prototype.put=function(t,e,i,u){return void 0===e&&(e={}),void 0===i&&(i={}),void 0===u&&(u=!1),r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this.request(a.PUT,t,n(n({},i),{data:e}),u)]}))}))},u.prototype.patch=function(t,e,i,u){return void 0===e&&(e={}),void 0===i&&(i={}),void 0===u&&(u=!1),r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this.request(a.PATCH,t,n(n({},i),{data:e}),u)]}))}))},u.prototype.delete=function(t,e,i,u){return void 0===e&&(e={}),void 0===i&&(i={}),void 0===u&&(u=!1),r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this.request(a.DELETE,t,n(n({},i),{data:e}),u)]}))}))},u.prototype.postForm=function(t,e,i,u){return void 0===e&&(e={}),void 0===i&&(i={}),void 0===u&&(u=!1),r(this,void 0,void 0,(function(){var r;return o(this,(function(o){return r=new FormData,Object.keys(e).forEach((function(t){r.append(t,"object"==s.typeof(e[t])?JSON.stringify(e[t]):e[t])})),[2,this.request(a.POST,t,n(n({},i),{data:r,headers:{"Content-Type":"multipart/form-data;charset=UTF-8;"}}),u)]}))}))},u.prototype.postFile=function(t,e,i,u,s,c,l){return void 0===i&&(i="file"),void 0===u&&(u=!1),void 0===s&&(s=!1),void 0===c&&(c={}),void 0===l&&(l=!1),r(this,void 0,void 0,(function(){var r;return o(this,(function(o){return r=new FormData,Array.isArray(e)?e.forEach((function(t,e){s?r.append(u?"".concat(i,"[]"):"".concat(i,"[").concat(e,"]"),t):r.append(i,t)})):r.append(i,e),[2,this.request(a.POST,t,n(n({},c),{data:r,headers:{"Content-Type":"application/x-www-form-urlencoded"}}),l)]}))}))},u.prototype.cancelRequest=function(t){var e,n;if(this._cancelDuplicatedRequest){try{for(var r=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(this._pendingRequests),o=r.next();!o.done;o=r.next()){var a=i(o.value,2),u=a[0];(0,a[1])(t?"".concat(t,": ").concat(u):u)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this._pendingRequests.clear()}else this._cancelTokens.forEach((function(e){null==e||e.cancel(t)}));return this},u.prototype.cancelWhiteListRequest=function(t){return this._whiteListCancelTokens.forEach((function(e){null==e||e.cancel(t)})),this},u.prototype.getCancelToken=function(){return t.CancelToken.source()},u.prototype.getBaseURL=function(){return this.instance.defaults.baseURL},u.prototype.setBaseURL=function(t){return this.instance.defaults.baseURL=t,this},u.prototype.getHeaders=function(){return this.instance.defaults.headers},u.prototype.setHeaders=function(t){return this.instance.defaults.headers=t,this},u.prototype.getHeader=function(t){return this.instance.defaults.headers.common[t]},u.prototype.setHeader=function(t,e){return e?this.instance.defaults.headers.common[t]=e:delete this.instance.defaults.headers.common[t],this},u.prototype.setRequestTimeout=function(t){return this.instance.defaults.timeout=t,this},u.prototype.getAuthToken=function(){var t=this.getHeader("Authorization");return null==t?null:t},u.prototype.setAuthToken=function(t){return this.setHeader("Authorization",t),this},u.prototype.getInstance=function(){return this.instance},u.prototype.create=function(t,e){return void 0===e&&(e={}),new u(t,e)},u}());export{u as Axios,c as XHttp,a as XHttpMethod,s as XHttpUtils,c as default};
